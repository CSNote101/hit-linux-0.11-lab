# 对磁盘的抽象

下面讲的抽象层次时从磁盘开始逐步到程序，只是简单的说明。

## 第一层抽象 `block`号

对磁盘的读写需要使用柱面(C)，磁头(H)和扇区(S)。通过操作系统增加一层抽象，使用block来读取磁盘。

```
block = C*(Heads*Sectors) + H*Sectors + S
```

这样简化来磁盘的读写，只需要输入`block`号即可。



## 第二层抽象 多进程使用磁盘

当多个进程使用磁盘时，来自不同进程的请求放入一个请求队列中，然后根据磁盘调度算法来从请求队列中取出请求，读取磁盘。使得看上去多个进程同时使用磁盘。



## 第三层抽象 文件

磁盘中储存着文件。文件抽象是为每一个文件创建一个结构体叫`inode`，在`inode`里面存放着文件在磁盘中的`block`号，和一些文件的描述信息。这样就可以通过文件的`inode`来找到相应的`block`号，从而从磁盘中读取文件。

在磁盘的头部，有一个叫`super_block`的区域，那里面存放着有多少个(可用/空闲)`inode`和数据块。一个`inode`就是一个文件。



## 第四层 目录

通过目录实现文件系统。根据文件的目录，可以找到一个文件的`inode`，然后通过文件的`inode`找到相应的`block`号，放入请求队列等待读取磁盘。







